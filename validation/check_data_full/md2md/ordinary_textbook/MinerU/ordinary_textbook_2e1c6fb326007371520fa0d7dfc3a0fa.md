# 2019年罗马尼亚大师杯(RMM)  

# 组合部分预选题  

韩新淼  

（浙江乐清知临中学，325600）指导教师：羊明亮  

罗马尼亚大师杯（RMM）是由罗马尼亚数学会主办的一场国际邀请赛，自2008年开始每年于2月举办，是一个在国际上十分重要的比赛.本文为2019年RMM组合部分的预选题,共3道题.笔者认为第二题相对简单，第一题和第三题较难。  

于笔者水平，文中若有不当之处，请读者批评指正  

# I.试题  

1．已知正整数  $k$   $N$  满足：  $k>1$   $N>2k+1$  .现有  $N$  个人围绕圆桌坐成 一圈，其中每个人要么是骑士(永远说真话)要么是骗子(永远说假话)，且每个人都可以看到他左侧(顺时针方向)的 $k$ 个人和右侧(逆时针方向)的 $k$ 个人.如果每个人都说“我能看到的左侧的骑士人数和右侧的骑士人数一样多”.那么，是否每个人都一定是骑士？  

2.给定止整数 $n\geq2$ 我们在一个 $3n\times3n$ 的国际象棋棋盘的某个单元格中放置一枚棋子“王”，已知“王”在每一步可以向上移动一格，或向右移动一格或向其左下方移动一格.若经过 $k$ 步之后，该棋子回到了初始位置，并且移动过程中每个单元格至多经过一次.试求 $k$ 的最大值  

3.给定奇数 $n>1$ ，对 $1,\;2,\,\cdots\;,\;n$ 的一个排列 $p_{1}$ ，···， $p_{n}$ ，记 $S$ 为满足：当 $1\leq i\leq j\leq n$ 时,有 $n\mid p_{i}+p_{i+1}+\cdot\cdot\cdot+p_{j}$ 的数对 $(i,\,j)$ 的数目.求 $S$ 的最大值  

# II．解答与评注  

1．已知正整数  $k$   $N$  满足：  $k>1$   $N>2k+1$  .现有  $N$  个人围绕圆桌坐成 一圈，其中每个人要么是骑士(永远说真话)要么是骗子(永远说假话)，且每个人都可以看到他左侧(顺时针方向)的 $k$ 个人和右侧(逆时针方向)的 $k$ 个人.如果每个人都说“我能看到的左侧的骑士人数和右侧的骑士人数一样多”.那么，是否每个人都一定是骑士？  

解当 $(N,\;2k+1)=1$ 时，每个人一定是骑士；当 $(N,\;2k+1)>1$ 时，不一定每个人都是骑士  

一方面，当 $(N,\,2k+1)=d>1$ 时,进行构造  

对于 $1\leq i\leq N$ 当 $i\equiv1$ (mod $d$ ）时，令第 $i$ 人为骑士,否则令第 $i$ 人为骗子.  

此时对于每一个骗子,注意到连续 $2k+1$ 人中恰 $\textstyle{\frac{2k+1}{d}}$ 个骑士,那么骗子看到的骑士数为 $\textstyle{\frac{2k+1}{d}}$ 奇数个,左右两侧看到的骑士数奇偶性不同,那么骗子撒谎满足要求.而对于每一个骑士，他左侧 $k$ 人与右侧 $k$ 人是对称的，他说了真话，满足要求.  

另一方面，我们证明 $(N,\,2k+1)=1$ 时，每个人必为骑士.令  

$f(i)={\binom{1,}{1,}}$ 第 $i$ 人为骑士， $(1\leq i\leq N)$  ,且  $f(i+N)=f(i),\;(i\in\mathbb{Z})$  第 $i$ 人为骗子，  

$$
g(i)=\sum_{j=i-k}^{i}f(j)-\sum_{j=i}^{i+k}f(j),
$$  

由条件知, $f(i)=0$ 时， $g(i)\neq0;f(i)=1$ 时， $g(i)=0$ .由 $g(i)$ 表达式知  

$$
g(i+1)-g(i)=f(i+1)+f(i)-f(i-k)-f(i+k+1),
$$  

首先， $f(i)$ 不全为0.不然,结合 $g(i)$ 表达式知, $g(i)$ 全为0,与 $f(i)=0$ 时， $g(i)\neq0$ 矛盾！  

下对 $g(i+1)-g(i)$ 的值分类讨论  

$\textcircled{1}$ 当 $f(i)=f(i+1)=0$ 时,结合 $(*)$ ，有  

$$
g(i+1)-g(i)=-f(i-k)-f(i+k+1)\leq0.
$$  

$\circledast$ 当 $f(i)=0,\ f(i+1)=1$ 时,有 $g(i+1)=0,\;g(i)\neq0.$ 结合 $(*)$ ，有  

$$
-g(i)=g(i+1)-g(i)=1-f(i-k)-f(i+k+1).
$$  

而 $f(i-k)\in\{0,\,1\},\;f(i+k+1)\in\{0,\,1\}$ ，所以  

$$
1-f(i-k)-f(i+k+1)\in\{-1,\,0,\,1\},
$$  

结合 $g(i)\neq0$ 知， $g(i)\in\{-1,\;1\},\;g(i+1)-g(i)\in\{-1,\;1\}.$  $\textcircled{3}$ 当 $f(i)=1$ ， $f(i+1)=0$ 时,与 $\circledast$ 同理,知 $g(i+1)-g(i)\in\{-1,\,1\}$  

I）下面考虑使得 $f(i)=0$ 的 $i$ .结合 $f(i)$ 不全为0知,存在最小的 $s$  $t\in\mathbb{N}^{*}$ 使得  

$$
f(i-s)=f(i+t)=1.
$$  

结合 $\mathbf{\nabla}\cdot\left(\mathbf{\widehat{2}}\right)\!\left(\mathbf{3}\right)$ 与 $g(i-s)=g(i+t)=0$ 知  

$$
g(i-s+1),\;g(i+t-1)\in\{-1,\;1\},
$$  

再结合 $\cdot(\widehat{\mathbf{\Phi}})$ 知  

$$
1\geq g(i-s+1)\geq g(i-s+2)\geq\cdot\cdot\cdot\geq g(i+t-1)\geq-1
$$  

而由  $f(i)=0$  知  $g(i)\neq0$  ，结合  $|g(i)|\leq1$  知  $2\nmid g(i)$  ，那么  

$$
f(i)-g(i)\equiv1{\pmod{2}}.
$$  

II)再考虑使得 $f(i)=1$ 的 $i$ 此时 $g(i)=0$  

$$
f(i)-g(i)\equiv1{\pmod{2}}.
$$  

那么对于 $\forall i\in\mathbb{Z},\;f(i)-g(i)\equiv1{\mathrm{~(mod~}}2)$ ，代入 $(*)$ 得  

$$
f(i-k)\equiv f(i+k+1){\pmod{2}},
$$  

那么 $f(i\mathrm{~-~}k)\,=\,f(i\mathrm{~+~}k\mathrm{~+~}1)$ .于是 $2k+1$ 为 $f(i)$ 的周期,结合 $N$ 为周期知 $(2k+1,\;N)=1$ 也为 $f(i)$ 的周期.而 $f(i)$ 不全为0,所以 $f(i)$ 全为1  

综上， $(N,\,2k+1)=1$ 时，每个人都为骑士， $(N,\;2k+1)>1$ 时，不一定每人为骑士.口  

评注本题易想到从一个具有特殊意义的“值”考虑，经过一定的推理，可找到关于该“值”的变化规律，从而找到思路.  

2.给定正整数 $n\geq2$ ：我们在一个 $3n\times3n$ 的国际象棋棋盘的某个单元格中放置一枚棋子“王”，已知“王”在每一步可以向上移动一格，或向右移动一格，或向其左下方移动一格.若经过 $k$ 步之后，该棋子回到了初始位置，并且移动过程中每个单元格至多经过一次.试求 $k$ 的最大值  

解 $k$ 的最大值为 $9n^{2}-3$  

(i）一方面,给出构造：对 $3n$ 行 $3n$ 列的方格表自上向下，自左向右分别为行、列编号 $1,\;2,\;\cdot\cdot\cdot\;,\;3n.$ 对第 $i$ 行,第 $j$ 列的格子,记为 $(i,\;j)1\leq i$ ， $j\leq3n$ .对王在的格子 $(i,\,j)$  

$\circledast i\,=\,3s(s\,=\,1,\,\,2,\,\,\cdot\cdot\,\cdot\,\,n)$  及  $j\,=\,1$  或  $j\,=\,t(t\,=\,3,\ 4,\ \cdot\cdot\cdot\,,\ 3n+1)$  或  $(i,\ j)=(3n,\ 2)$  时，则王向右走  

$\circledast s=3n-1(s=1,\ 2,\ \cdot\cdot\cdot\ ,\ n)$  及  $j=t(t=3,\ 4,\ \cdot\cdot\cdot\ ,\ 3n)$  时或  $\begin{array}{r}{i=3s(s=}\end{array}$   $1,\;2,\;\cdot\cdot\cdot\;,\;n)$ 及 $j=3n$ 时，王向上走，  

$\textcircled{3}$ 对除了(1，1)，(1,2)，(2，1)及 ${\mathfrak{Q}},{\mathfrak{Q}}$ 中格子外的格子时,王向左下走连出王行走轨迹(王从 $(3n,\;1)$ 出发)，如图1，是满足要求的，且 $k=9n^{2}-3$  

![](images/a57ffb452e2ad4347baa34b41d324682a4ed7b0f3455bc9aeed816f37770ec3d.jpg)  
图1  

(ii)另一方面，假设 $k\,>\,9n^{2}\,-\,3$ ，注意到王行走了一个圈，那么王若向左下方走了 $t$ 步,则必要向上及向右走 $t$ 步.于是王走的步数为3的倍数,故 $3\mid k$ 又 $k\leq9n^{2}$ ，知 $k=9n^{2}$ .即王要经过全部的格  

那么,我们考虑左上方和右下方(1，1)，(1,2)，(2,1);(3n－1,3n)， $(3n,\,3n-$ 1)， $(3n,\;3n)$ .注意到要过(1，1)， $(3n,\;3n)$ 结合王只能向上、向右、向左下走，于是必有 $(2,\;1)\rightarrow(1,\;1)\rightarrow(1,\;2),\;\;\;(3n,\;3n-1)\rightarrow(3n,\;3n)\rightarrow(3n-1,\;3n).$  

![](images/0777276bfdee49473b272e87c3beeb400f0e26d261619851bcec6525e1f1daaf.jpg)  
图2  

如图 2,整个路径封闭,知王一定是从(1，2)走到 $(3n,\;3n-1)$ 且从 $(3n-$  $1,\;3n)$ 走到 (2，1).分别称其为路径 $M$ ，路径 $N$ 则 $M$ 将表分为了两部分，(2，1) $(3n\!-\!1,\,3n)$ 各在一部分.于是路径 $N$ 一定与路径 $M$ 相交.而无论路径 $M$ 在交点 $\rightarrow$   $\uparrow$   $\swarrow$  交叉,否则必有交格,但王只能向左下移动,故不成立.因此 $k\leq9n^{2}-3$  

综上， $k$ 的最大值为 $9n^{2}-3$  

评注 本题关键在于两个方面，一个则是先猜对答案，发现仅3个格不到是极为关键的.这点从较小的 $n$ 摸索是可以发现的.另一个就是抓住特殊元素，即左上角，右下角，分析就可以完善证明，  

3.给定奇数 $n>1$ ，对1,2，···， $n$ 的一个排列 $p_{1}$ ，···， $p_{n}$ ，记 $S$ 为满足：当 $1\leq i\leq j\leq n$ 时，有 $n\mid p_{i}+p_{i+1}+\cdot\cdot\cdot+p_{j}$ 的数对 $(i,\,j)$ 的数目.求 $S$ 的最大值  

解1  $\begin{array}{r}{S_{\mathrm{max}}=\frac{(n+1)(n+3)}{8}}\end{array}$  

$\textstyle\left(p_{1},p_{2},\dotsc,p_{n}\right)\,=\,\left(n,1,n-1,2,n-2,\dotsc,\frac{n-1}{2},\frac{n+1}{2}\right)$   $n\mid p_{i}+\cdot\cdot\cdot+p_{j}$ 的 $(i,j)$ 对. 将 $\textstyle n,(1,n-1),(2,n-2),\cdot\cdot\cdot,\left({\frac{n-1}{2}},{\frac{n+1}{2}}\right)$ 看作 $\textstyle{\frac{n+1}{2}}$ 个整体.任意取一个连续和均为一个满足要求的排列，所以  

$$
S\geq\mathrm{C}_{\frac{n+1}{2}}^{2}+\frac{n+1}{2}=\frac{(n+1)(n+3)}{8}.
$$  

(2)另一方面，下面证明 $\textstyle S\leq{\frac{(n+1)(n+3)}{8}}$  

为方便，记  

$$
\sigma_{i j}=p_{i}+p_{i+1}+\cdot\cdot\cdot+p_{j},\;1\leq i\leq j\leq n.
$$  

我们将其分为3类  

$$
\begin{array}{r l}&{A=\Big\{(i,\;j)\Big|\;n\;|\;\sigma_{i j}\;\boxplus p_{i}=n\;\boxplus p_{j}=n\Big\},}\\ &{B=\Big\{(i,\;j)\Big|\;n\;|\;\sigma_{i j}\;\boxplus n\;|\;p_{i}+p_{j}\;\boxplus p_{i},\;p_{j}\neq n\Big\},}\\ &{C=\Big\{(i,\;j)\Big|\;n\;|\;\sigma_{i j}\;\boxplus n\;\not\;p_{i}+p_{j}\;\boxplus p_{i},\;p_{j}\neq n\Big\}.}\end{array}
$$  

则  $S=|A|+|B|+|C|$  

设  $p_{t}~=~n$  ,则  $(t,t)\;\in\;A,\;\,(t\,-\,1,t),(t,t\,+\,1)$  均不在  $A,B,C$  中.先考虑  $(i,t),\;i<t-1$ ，将数两两配对（可能剩一个）如下：  

$$
((t-2,\ t),\ (t-3,\ t))\,,\ ((t-4,\ t),\ (t-5,\ t))\,,\ \cdot\cdot\cdot
$$  

每一对里最多一个在 $A$ 中，否则 $n\mid\sigma_{i,t,}\;n\mid\sigma_{i-1,t,}\;(i=t-2,\;t-4,\;\cdot\cdot\,)$ 两式相减 $n\mid p_{i}$ 与 $i\neq t$ 矛盾!因此 $(i,\ t)$ ， $i<\,t\mathrm{~-~}1$ 中最多仅有 $\textstyle\left[{\frac{t-2+1}{2}}\right]$ 个.类似的 $(i,\ t)$ ， $i>t+1$ 中最多仅有 $\textstyle\left[{\frac{n-t-1+1}{2}}\right]$ 个.所以  

$$
|A|\leq\left[{\frac{t-2+1}{2}}\right]+\left[{\frac{n-t-1+1}{2}}\right]+1\leq{\frac{n+1}{2}}{\big(}\nmp(t,\,t)\in A\,{\big)}
$$  

对 $B$ 中任意元素 $(i,\,j)$ 有 $n\mid p_{i}+p_{j}$ .最多 $\textstyle{\frac{n-1}{2}}$ 对,则 $\textstyle|B|\leq{\frac{n-1}{2}}$  

再考虑 $C$ 中的元素,注意到 $i$  $j\neq t$ 且 $n\mid n$ 故 $p_{t}$ 在哪对 $\sigma_{i j}$ 的 $\bmod{n}$ 的值无影响.不妨设 $t=n$ 记 $K_{i}=\{2i-1,\;2i\}$ ， $\textstyle1\leq i\leq{\frac{n-1}{2}}$ .注意到 $C$ 中的元素 $(i,\ j)$ 满足 $n\nmid p_{i}+p_{j}$ .因此 $(i,\,j)$ 不在同一个 $\begin{array}{r}{K_{u}(1\leq u\leq\frac{n-1}{2})}\end{array}$ 中.  

设  $i\in K_{u_{1}}$   $j\in K_{u_{2}}$   $u_{1}<u_{2}$  .考虑  $\sigma_{2u_{1}-1,2u_{2}-1},\;\sigma_{2u_{1}-1,2u_{2}},\;\sigma_{2u_{1},2u_{2}-1},\;\sigma_{2u_{1},2u_{2}}.$  下证这四个元素最多有一个在 $C$ 中  

否则,至少两个在 $C$ 中,由于 $p_{2u_{1}-1},\;p_{2u_{1}},\;p_{2u_{2}-1},\;p_{2u_{2}}\not\equiv0\;\,(\mathrm{mod}\ n).$  

若 $(2u_{1}-1,\;2u_{2}-1)\in C_{\ast}$ 则 $(2u_{1},\;2u_{2}-1)\notin C,(2u_{1}-1,\;2u_{2})\notin C.$ 从而 $(2u_{1},\;2u_{2})\in C.$ 于是 $p_{2u_{1}-1}\equiv p_{2u_{2}}$ (mod $n$ )，矛盾！  

故  $(2u_{1}\,-\,1,\ 2u_{2}\,-\,1)\ \notin\ C,$  同理  $(2u_{1},~2u_{2})~\notin~C$  则  $\left(2u_{1}\,-\,1,\ 2u_{2}\right)\ \in$   $C$  $(2u_{1},\ 2u_{2}\,-\,1)\ \in\ C.$ 但由定义可知 $(2u_{1}\,-\,1,~2u_{2})~\in~B$ ，矛盾!故 $(2u_{1}\;-$ 1, $2u_{2}-1)$ ， $(2u_{1}-1,\;2u_{2}),\;(2u_{1},\;2u_{2}-1),\;(2u_{1},\;2u_{2})$ 最多一个在 $C$ 中,可将 $K_{i}$ 看作整体 $\textstyle1\leq i\leq{\frac{n-1}{2}}$ .因此 $|C|\le C_{\frac{n-2}{2}}^{2}$ .故  

$$
S\leq|A|+|B|+|C|\leq\frac{n+1}{2}+\frac{n-1}{2}+C_{\frac{n-1}{2}}^{2}=\frac{(n+1)(n+3)}{8}.
$$  

综上,有  

$$
S_{\mathrm{max}}={\frac{(n+1)(n+3)}{8}}.
$$  

评注答案是容易的，重点在于估计，此种解法完全按照构造的想法估计，配对放缩.虽略显繁琐但极其自然，是算两次与一一对应的“典范”：  

解2 $S_{\mathrm{max}}=\mathrm{C}_{\frac{n+3}{2}}^{2}$ 记 $n=2k+1,\;k\in\mathbb{N}^{*}$  $p$   $S\geq\mathrm{C}_{k+2}^{2}$  

取 $p_{2i-1}\,=\,i$  $p_{2i}=2k+1-i,\ i=1,\ \cdot\cdot\cdot,\ k,\ p_{2k+1}=2k+1$ 则 $\forall i$ ， $j\in$  $\{0,\;2,\;4,\;\cdot\cdot\;,\;2k,\;2k+1\}$ ， $i<j,$ 均有 $p_{i+1}+p_{i+2}+\cdot\cdot\cdot+p_{j}$ 为 $2k+1$ 的倍数(因 $2k+1\mid p_{2u-1}+p_{2u},\;u=1,\;\cdot\cdot\;,\;k,\;2k+1\mid p_{2k+1}\;)$   $S\geq\mathrm{C}_{k+2}^{2}$  

$S\leq\mathrm{C}_{k+2}^{2}$  

记  $\sigma_{j}=p_{1}\!+\!p_{2}\!+\!\cdot\cdot\!+\!p_{j},\;j=0,\,1,\;\cdot\cdot\,,\,2k\!+\!1,$  则  $\forall t\in\mathbb{Z}$  满足  $1\leq j\leq2k\!+\!1$  且 $\sigma_{j}-\sigma_{j-1}\equiv t$ (mod $2k+1)$ ）的 $j$ 恰有一个.于是, $\forall r\in\mathbb{Z}$ ，满足 $0\leq j\leq2k+1$ 且 $\sigma_{j}\equiv r~(\mathrm{mod}~2k+1)$ 的 $j$ 至多 $k+2$ 个(因为这样的 $j$ 中相邻对至多一对)及  $\forall u$  ，  $v\in\mathbb{Z}$  ，满足  $0\leq j\leq2k+1$  且  $\sigma_{j}\equiv u$  或  $v$   $(\bmod~2k+1)$  的  $j$  至多  $k+3$  个(因为这样的 $j$ 中相邻对至多三对).  

考虑  

$$
\sigma_{u}\equiv\sigma_{v}{\pmod{2k+1}}
$$  

的有序组 $(u,\,v)$ 个数.任取 $i\in\{0,\ 1,\ \cdots,\ k\}$  

若 $\sigma_{2i}\,\not\equiv\,\sigma_{2i+1}$ (mod $2k+1$ )，则满足 $\sigma_{j}\,\equiv\,\sigma_{2i}$ 或 $\sigma_{2i+1}$ (mod $2k+1$ ）， $0\,\leq$  $j\leq2k+1$  的  $j$  至多  $k+3$  个，则  $(*)$  的满足  $v=2i$  或  $2i+1$  的解数至多  $k+3$  个  

若  $\sigma_{2i}\equiv\sigma_{2i+1}$   $(\bmod{\ }2k+1)$  ，则满足  $\sigma_{j}\equiv\sigma_{2i}~(\mathrm{mod}~2k+1),~0\leq j\leq2k+1$  的  $j$  至多  $k+2$  个，则  $(*)$  的满足  $v=2i$  或  $2i+1$  的解数至多  $2(k+2)$  个，且此 类 $i$ 至多一个.  

因此， $(*)$ 解数至多 $k(k+3)+2(k+2)=k^{2}+5k+4.$ 于是, $\sigma_{u}\equiv\sigma_{v}$ 且 $u<v$ 的解 $(u,\,v)$ 至多  

$$
\frac{1}{2}((k^{2}+5k+4)-(2k+2))=\frac{1}{2}(k^{2}+3k+2).
$$  

即  

$$
s\leq\mathrm{C}_{k+2}^{2}.
$$  

综上,  $S_{\mathrm{max}}=\mathrm{C}_{\frac{n+3}{2}}^{2}$  

评注本题将连续若干项的和化为部分和能看起来清晰一点，也是常见手法.单纯用单个项去计数会不太够，结合取等，便退一步考虑两项一起计.  